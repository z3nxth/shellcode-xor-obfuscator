#include <stdio.h>
#include <stdint.h>
#include <string.h>

int main(void) {

    unsigned char buf[] =
    "\xfc\x48\x48\x48\x48\x48\x48\x48\x48\x48\x48\x48\x48\x48"
    "\x48\x48\x48\x48\x48\x48\x48\x48\x48\x48\x48\x48\x48\x48"
    "\x48\x48\x48\x48\x48\x48\x48\x48\x48\x48\x48\x48\x48\x48"
    "\x48\x48\x488\x4THIS IS EXAMPLE SHELLCODEx48\x48\x48\x48"
    "\x48\x48\x48\x48\x48\x48\x48\x48\x48\x48\x48\x48\x48\x48"
    "\x48\x48\x48\x48\x48\x48\x48\x48\x48\x48\x48\x48\x48\x48"
    "\x48\x48\x48\x48\x48\x48\x48\x48\x48\x48\x48\x48\x48\x48"
    "\x48\x48\x488\x4THIS IS EXAMPLE SHELLCODEx48\x48\x48\x48"
    "\x48\x48\x488\x4THIS IS EXAMPLE SHELLCODEx48\x48\x48\x48"
    "\x48\x48\x488\x4THIS IS EXAMPLE SHELLCODEx48\x48\x48\x48"
    "\x48\x48\x488\x4THIS IS EXAMPLE SHELLCODEx48\x48\x48\x48"
    "\x48\x48\x488\x4THIS IS EXAMPLE SHELLCODEx48\x48\x48\x48"
    "\x48\x48\x488\x4THIS IS EXAMPLE SHELLCODEx48\x48\x48\x48"
    "\x48\x48\x488\x4THIS IS EXAMPLE SHELLCODEx48\x48\x48\x48"
    "\x48\x48\x48\x48\x48\x48\x48\x48\x48\x48\x48\x48\x48\x48"
    "\x48\x48\x48\x48\x48\x48\x48\x48\x48\x48\x48\x48\x48\x48"
    "\x48\x48\x48\x48\x48\x48\x48\x48\x48\x48\x48\x48\x48\x48"
    "\x48\x48\x48\x48\x48\x48\x48\x48\x48\x48\x48\x48\x48\x48"
    "\x48\x48\x488\x4THIS IS EXAMPLE SHELLCODEx48\x48\x48\x48";

    char *key = "z3nxth";     // XOR key

    printf("XOR-encoded bytes (hex):\n");

    size_t shellcodelen = sizeof(buf);
    size_t keylen = strlen(key);

    for (size_t i = 0; i < shellcodelen; i++) {
        printf("\\x%02X", (uint8_t)(buf[i] ^ (uint8_t)key[i % keylen]));
    } puts("");

    return 0;
}

